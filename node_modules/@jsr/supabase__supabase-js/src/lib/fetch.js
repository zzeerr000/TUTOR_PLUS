export const resolveFetch = (customFetch)=>{
  if (customFetch) {
    return (...args)=>customFetch(...args);
  }
  return (...args)=>fetch(...args);
};
export const resolveHeadersConstructor = ()=>{
  return Headers;
};
export const fetchWithAuth = (supabaseKey, getAccessToken, customFetch)=>{
  const fetch1 = resolveFetch(customFetch);
  const HeadersConstructor = resolveHeadersConstructor();
  return async (input, init)=>{
    const accessToken = await getAccessToken() ?? supabaseKey;
    let headers = new HeadersConstructor(init?.headers);
    if (!headers.has('apikey')) {
      headers.set('apikey', supabaseKey);
    }
    if (!headers.has('Authorization')) {
      headers.set('Authorization', `Bearer ${accessToken}`);
    }
    return fetch1(input, {
      ...init,
      headers
    });
  };
};
//# sourceMappingURL=fetch.js.map